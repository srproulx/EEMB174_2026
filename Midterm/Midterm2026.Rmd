---
title: "Midterm2026"
author: "Stephen R. Proulx"
date: "2026-02-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(rethinking)
#source("../helper.R")

``` 



## Short Awnswer 

### Question 1 (6 pts)
Recall your Bayesian data analysis mantra. 

Part A)
Write it out in word format:


Part B)
Write it out in probability statement format (i.e. Pr(B|A) etc):



### Question 2 (6 pts)
What are the 3 sections that we can use to mathematically describe a Bayesian model?  




### Question 3 (6 pts)
Your friend shows you a dataset from their experiment in astral zenobiology. They have 20 independent observations of the mental life-force of virtual lifeforms, and they insist that due to their knowledge of the system, the appropriate distribution for the observations is the Sakanaesse distribution, defined as $S(y | \mu,\theta)$ (here we are defining the probability (or likelihood) of seeing a value $y$ given two parameters $\mu$ and $\theta$). 

The data you are given are in a table where column $y$ is the observed value, so $y_i$ is the value for individual observation $i$. 

Part A) Say we want to know the likelihood of the data if $\mu = 5 $ and $\theta = 0.5$.Write out the likelihood formula in mathematical terms (like you would on paper or the board). Be sure to account for each data point and combine them appropriately.

Here is the left hand side of the equations:

Pr( d | mu, theta) = 



Part B) Write out the likelihood formula on the log scale, i.e. $log( Pr(y|\mu,\theta) )$


## Analysis Challenge (82 points)

For this midterm exercise we will use data from this paper:  https://onlinelibrary.wiley.com/doi/10.1111/oik.07674 . We will use only a portion of their data, but our analysis will involve similar models to the ones discussed in the paper. You are free to read the paper or look to it for modeling inspiration, but you can complete this entire exercise without looking at the paper. 


In this study, clown fish were observed in breeding groups associated with sea anemones. In the dataset, each row is an observation.

The dataframe has 236 observations of 61 unique fish groups (labeled by Anemone_ID). Anemone size is taken to represent the food-richness of the area the fish live in, so anemone size might influence fish health and therefore fish reproductive output. 

The dataset includes a treatment, which is that some of the groups of fish were fed additional food. The column "FedIndex" is 1 if the fish were not fed, and 2 if they were fed. The treatment was performed in the middle of the season, so that some clutches of eggs were produced before the treatment, and others were produced after the treatment. The column "PostTreatment" is 1 if the clutch was laid before the treatment and 2 if it was after. Note that fish in the FedIndex=1 category were never fed additional food, even if PostTreatment=2. 

First clear your working environment and load the data.
```{r}
rm(list=ls())

load("ClownFishData.RData")
```

You now have an object called "data" in your environment. Take a few minutes to inspect it.




### (1) Standardize and plot
We will be using anemone_area as a predictor. Since it is a continuous variable, it's a good idea to standardize it. Name the standardized version of this column "AA".

Standardize your data columns using the "standardize" command. 
```{r}
d2<-
```


Make a figure showing the relationship between anemone area and number of eggs laid. Describe how this changes our data values
```{r}
ggplot( YOURDATAFRAMENAMEHERE , aes(x=AA ,y=Eggs_Laid )) +geom_point()
```



### (2) Plotting a prior
You will construct a linear regression model for the number of eggs laid with the anemone area (standardized) as the predictor. The model is

$$
\mathrm{Eggs\_Laid} \sim \mathrm{Normal(\mu,\sigma)}\\
\mu = a + b * \mathrm{AA} \\
a \sim \mathrm{Normal(0,?)} \\
b \sim \mathrm{Normal(0,2)} \\
\sigma \sim \mathrm{Exponential(1)} \\
$$
Choose values of the standard deviation for the parameter a (the ? in the formula above). Plot the prior with the data. Change the values until you are satisfied that this is a reasonable prior. Explain how you settled on the value that you used.






### (3) Linear regression model
Construct a *quap* model for the data and use `precis` to summarize the output.




### (4) Compare to a model with no predictor
Now re-write your quap model, but remove the linear regression predictor. In other words, just model the mean and variance of the number of eggs laid. Explain how and why the values for sigma differ between the linear regression model and the model with no predictor.



### (5) Plot the linear regression lines
Use `link_df` to create samples of the *quap* fit. To do this, create a dataframe with evenly spaced out values of AA. Plot the mu values on a graph with the data. 



### (6) List one "big world" explanation that could explain the differences between the data and the predicted values.



### (7) Looking at the effect of feeding the clown fish

Now we are going to look at the data broken down by whether or not the fish were fed, and before/after they were fed. Create four subsets of the data based on FedIndex (1 or 2) and Post Treatment (1 or 2). Create a separate quap model for each new subset of the data and report the parameter values. 






### (8) Interpret the fitted parameter values. How does feeding affect the clown fish reproduction?

